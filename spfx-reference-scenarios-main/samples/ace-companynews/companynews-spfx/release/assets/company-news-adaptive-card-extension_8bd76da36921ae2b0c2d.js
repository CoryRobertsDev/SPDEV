define("fe0523d4-6513-4991-bccf-45137e913875_0.0.1",["@microsoft/sp-loader","CompanyNewsAdaptiveCardExtensionStrings","@microsoft/sp-adaptive-card-extension-base"],function(t,e,n){return function(t){function e(e){for(var n,i,o=e[0],a=e[1],s=0,u=[];s<o.length;s++)i=o[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);for(c&&c(e);u.length;)u.shift()()}var n={},r={1:0};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){for(var n=[],a=function(t){return{0:[{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.13.0",m:"26ea"}]}[t]||[]}(e),s=0;s<a.length;s++)t[a[s].m]||function(e){n.push(o.SPComponentLoader.loadComponentById(e.i,e.v).then(function(n){t[e.m]=function(t){t.exports=n}}))}(a[s]);var u=r[e];if(0!==u)if(u)n.push(u[2]);else{var c=new Promise(function(t,n){u=r[e]=[t,n]});n.push(u[2]=c);var l,p=document.createElement("script");p.charset="utf-8",p.timeout=120,i.nc&&p.setAttribute("nonce",i.nc),p.src=function(t){return i.p+"chunk."+({0:"CompanyNews-property-pane"}[t]||t)+"_"+{0:"d1c46f74d7d655761b37"}[t]+".js"}(e),0!==p.src.indexOf(window.location.origin+"/")&&(p.crossOrigin="anonymous");var f=new Error;l=function(t){p.onerror=p.onload=null,clearTimeout(h);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",f.name="ChunkLoadError",f.type=i,f.request=o,n[1](f)}r[e]=void 0}};var h=setTimeout(function(){l({type:"timeout",target:p})},12e4);p.onerror=p.onload=l,document.head.appendChild(p)}return Promise.all(n)},i.m=t,i.c=n,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var o=i("I6O9");i.oe=function(t){throw console.error(t),t};var a=window.webpackJsonpfe0523d4_6513_4991_bccf_45137e913875_0_0_1=window.webpackJsonpfe0523d4_6513_4991_bccf_45137e913875_0_0_1||[],s=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var c=s;return function(){var t,e=document.getElementsByTagName("script"),n=/company-news-adaptive-card-extension_8bd76da36921ae2b0c2d\.js/i;if(e&&e.length)for(var r=0;r<e.length;r++)if(e[r]){var o=e[r].getAttribute("src");if(o&&o.match(n)){t=o.substring(0,o.lastIndexOf("/")+1);break}}if(!t)for(var a in window.__setWebpackPublicPathLoaderSrcRegistry__)if(a&&a.match(n)){t=a.substring(0,a.lastIndexOf("/")+1);break}i.p=t}(),i(i.s="gS5F")}({"08ZC":function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r});var r=void 0===t?window:t}).call(this,n("yLpj"))},EQtN:function(t,e,n){t.exports=n.p+"SharePointLogo_0101288365319b852f2a3b625daa3a5d.svg"},"G/4b":function(t){t.exports=JSON.parse('{"schema":"http://adaptivecards.io/schemas/adaptive-card.json","type":"AdaptiveCard","version":"1.2","body":[{"type":"TextBlock","weight":"bolder","text":"${title}","color":"accent","size":"large"},{"type":"Image","url":"${imageUrl}"},{"type":"ActionSet","actions":[{"id":"like2","type":"Action.Submit","iconUrl":"${likedIconUrl}","data":{"id":"${itemId}"}}]},{"type":"TextBlock","text":"${content}","separator":true,"wrap":true},{"type":"ColumnSet","separator":true,"columns":[{"type":"Column","width":"auto","items":[{"type":"Image","url":"${iconsvg}","height":"20px"}]},{"type":"Column","width":"stretch","items":[{"type":"TextBlock","text":"${topic}"}]}]}],"actions":[{"id":"like","type":"Action.Submit","iconUrl":"${likedIconUrl}","data":{"id":"${itemId}"}}]}')},I6O9:function(e,n){e.exports=t},gDJ0:function(t,n){t.exports=e},gS5F:function(t,e,n){"use strict";n.r(e),n.d(e,"QUICK_VIEW_REGISTRY_ID",function(){return ke});var r=n("lz/E"),i=n("gDJ0"),o=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.state.articleIndex<0?{primaryText:i.PrimaryText,imageUrl:"https://blogs.microsoft.com/uploads/2017/09/WR-Microsoft-logo.jpg",title:"Loading...",iconProperty:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'%3E%3Cpath d='M1408 640v384h-384V896h190q-45-60-112-94t-142-34q-59 0-111 20t-95 55-70 85-38 107l-127-22q14-81 54-149t98-118 133-78 156-28q91 0 174 35t146 102V640h128zm-448 768q58 0 111-20t95-55 70-85 38-107l127 22q-14 81-54 149t-98 118-133 78-156 28q-91 0-174-35t-146-102v137H512v-384h384v128H706q45 60 112 94t142 34z' fill='%23333333'%3E%3C/path%3E%3C/svg%3E"}:this.state.articles[this.state.articleIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardButtons",{get:function(){if(this.state.articleIndex>-1){var t=[];return this.state.articleIndex>0&&t.push({id:"prev",title:"Prev",action:{type:"Submit"}}),this.state.articleIndex<4&&t.push({id:"next",title:"Next",action:{type:"Submit"}}),t}},enumerable:!0,configurable:!0}),e.prototype.onAction=function(t){var e,n;"next"===(null===(e=t)||void 0===e?void 0:e.id)?this.setState({articleIndex:this.state.articleIndex+1}):"prev"===(null===(n=t)||void 0===n?void 0:n.id)&&this.setState({articleIndex:this.state.articleIndex-1})},Object.defineProperty(e.prototype,"onCardSelection",{get:function(){return{type:"QuickView",parameters:{view:"CompanyNews_QUICK_VIEW"}}},enumerable:!0,configurable:!0}),e}(r.BaseImageCardView);function s(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){e.apply(t,n)}}function u(t,e,n){var r=new Date(t.toString());switch(e.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.filter(function(t){return!y(t)}).map(function(t){return t.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")}).join("/").replace(/\\/g,"/")}function l(){var t=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})}function p(t){return"function"==typeof t}function f(t){return null!=t}function h(t,e,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!f(e))return t;var i=n?function(t,e){return!(e in t)}:function(){return!0};return Object.getOwnPropertyNames(e).filter(function(e){return i(t,e)&&r(e)}).reduce(function(t,n){return t[n]=e[n],t},t)}function d(t){return/^https?:\/\/|^\/\//i.test(t)}function y(t){return null==t||t.length<1}function g(t){return JSON.stringify(t)}function v(t,e){return Object.hasOwnProperty.call(t,e)}var b=p(Object.entries)?Object.entries:function(t){return Object.keys(t).map(function(e){return[e,t[e]]})},m=function(t,e){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function w(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function P(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})}function I(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function x(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}Object.create,Object.create;var S=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],_=[],T=function(){function t(t){var e=this;void 0===t&&(t=new Map),this._v=t;var n=function(t,n){e._v.has(t)||e._v.set(t,n)};n(S[0],"session"),n(S[1],60),n(S[2],!1),n(S[3],!1),n(S[4],750),n(S[5],null),n(S[6],!1),_.forEach(function(t){return t(e)})}return t.prototype.assign=function(t){var e;this._v=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)e[r].forEach(function(e,n){"string"==typeof n&&"spfxContext"!==n&&"[object Object]"===Object.prototype.toString.call(e)?t.set(n,Object.assign({},t.get(n)||{},e)):t.set(n,e)});return t}(this._v,f(e=t)?new Map(b(e)):new Map)},t.prototype.get=function(t){return this._v.get(t)},t.prototype.export=function(){var t,e,n=new Map;try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this._v),i=r.next();!i.done;i=r.next()){var o=x(i.value,2),a=o[0],s=o[1];"__isDefault__"!==a&&n.set(a,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t}(),C=new T(new Map([["__isDefault__",!0]])),O=n("08ZC");function R(t,e){f(e)&&new Request("",{headers:e}).headers.forEach(function(e,n){t.append(n,e)})}function E(t,e){if(f(e)){var n=h(t.headers||{},e.headers);(t=h(t,e)).headers=n}}var U=function(){function t(){}return t.prototype.fetch=function(t,e){return O.a.fetch(t,e)},t}(),L=(function(t){function e(e){var n=t.call(this,function(t){return P(n,void 0,void 0,function(){return I(this,function(n){switch(n.label){case 0:return[4,e.aadTokenProviderFactory.getTokenProvider()];case 1:return[2,n.sent().getToken((r=t.url,i=new URL(r),i.protocol+"//"+i.hostname))]}var r,i})})})||this;return n.context=e,n}w(e,t),e.prototype.getToken=function(t){return P(this,void 0,void 0,function(){return I(this,function(e){switch(e.label){case 0:return[4,this.context.aadTokenProviderFactory.getTokenProvider()];case 1:return[2,e.sent().getToken(t)]}})})}}(function(t){function e(e){var n=t.call(this,null)||this;return n.tokenFactory=e,n}return w(e,t),e.prototype.fetch=function(e,n){return P(this,void 0,void 0,function(){var r;return I(this,function(i){switch(i.label){case 0:return r=this,[4,this.tokenFactory({url:e,options:n})];case 1:return r.token=i.sent(),[2,t.prototype.fetch.call(this,e,n)]}})})},e}(function(t){function e(e){var n=t.call(this)||this;return n.token=e,n}return w(e,t),e.prototype.fetch=function(e,n){void 0===n&&(n={});var r=new Headers;return R(r,n.headers),r.set("Authorization","Bearer "+this.token),n.headers=r,t.prototype.fetch.call(this,e,n)},e}(U))),function(){function t(t,e){void 0===e&&(e=-1),this.store=t,this.defaultTimeoutMinutes=e,this.enabled=this.test(),C.get("enableCacheExpiration")&&this.cacheExpirationHandler()}return t.bind=function(e){return new t(void 0===e?new k:e)},t.prototype.get=function(t){if(!this.enabled)return null;var e=this.store.getItem(t);if(!f(e))return null;var n=JSON.parse(e);return new Date(n.expiration)<=new Date?(this.delete(t),null):n.value},t.prototype.put=function(t,e,n){this.enabled&&this.store.setItem(t,this.createPersistable(e,n))},t.prototype.delete=function(t){this.enabled&&this.store.removeItem(t)},t.prototype.getOrPut=function(t,e,n){return P(this,void 0,void 0,function(){var r;return I(this,function(i){switch(i.label){case 0:return this.enabled?null!==(r=this.get(t))?[3,2]:[4,e()]:[2,e()];case 1:r=i.sent(),this.put(t,r,n),i.label=2;case 2:return[2,r]}})})},t.prototype.deleteExpired=function(){return P(this,void 0,void 0,function(){var t,e;return I(this,function(n){switch(n.label){case 0:if(!this.enabled)return[2];t=0,n.label=1;case 1:return t<this.store.length?null===(e=this.store.key(t))?[3,3]:/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(e))?[4,this.get(e)]:[3,3]:[3,4];case 2:n.sent(),n.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},t.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(t){return!1}},t.prototype.createPersistable=function(t,e){if(void 0===e){var n=C.get("defaultCachingTimeoutSeconds");this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),e=u(new Date,"second",n)}return g({pnp:1,expiration:e,value:t})},t.prototype.cacheExpirationHandler=function(){var t=this;this.enabled&&this.deleteExpired().then(function(){setTimeout(s(t,t.cacheExpirationHandler),C.get("cacheExpirationIntervalMilliseconds"))}).catch(console.error)},t}()),k=function(){function t(t){void 0===t&&(t=new Map),this._store=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this._store.size},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this._store.clear()},t.prototype.getItem=function(t){return this._store.get(t)},t.prototype.key=function(t){return Array.from(this._store)[t][0]},t.prototype.removeItem=function(t){this._store.delete(t)},t.prototype.setItem=function(t,e){this._store.set(t,e)},t}(),D=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._local=t,this._session=e}return Object.defineProperty(t.prototype,"local",{get:function(){return null===this._local&&(this._local=new L("undefined"==typeof localStorage?new k:localStorage)),this._local},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"session",{get:function(){return null===this._session&&(this._session=new L("undefined"==typeof sessionStorage?new k:sessionStorage)),this._session},enumerable:!1,configurable:!0}),t}(),j=function(){function t(t){void 0===t&&(t=l()),this._batchId=t,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}return Object.defineProperty(t.prototype,"batchId",{get:function(){return this._batchId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requests",{get:function(){return this._reqs.sort(function(t,e){return t.index-e.index})},enumerable:!1,configurable:!0}),t.prototype.track=function(t){t.data.batch=this,(void 0===t.data.batchIndex||t.data.batchIndex<0)&&(t.data.batchIndex=++this._index)},t.prototype.add=function(t){var e={id:t.requestId,index:t.batchIndex,method:t.method.toUpperCase(),options:t.options,parser:t.parser,reject:null,resolve:null,url:t.url},n=new Promise(function(t,n){e.resolve=t,e.reject=n});return this._reqs.push(e),n},t.prototype.addDependency=function(){var t=function(){};return this._deps.push(new Promise(function(e){t=e})),t},t.prototype.addResolveBatchDependency=function(t){this._rDeps.push(t)},t.prototype.execute=function(){var t=this;return Promise.all(this._deps).then(function(){return Promise.all(t._deps)}).then(function(){return t.executeImpl()}).then(function(){return Promise.all(t._rDeps)}).then(function(){})},t}(),q=new D,F=function(){function t(t,e,n){this.key=t,this.storeName=e,this.expiration=n}return Object.defineProperty(t.prototype,"store",{get:function(){return"local"===this.storeName?q.local:q.session},enumerable:!1,configurable:!0}),t}(),A=function(){function t(t,e){this.parser=t,this.cacheOptions=e}return t.prototype.parse=function(t){var e=this;return this.parser.parse(t).then(function(t){return e.cacheData(t)})},t.prototype.cacheData=function(t){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,t,this.cacheOptions.expiration),t},t}();function B(t,e,n,r){Reflect.defineProperty(t.prototype,e,{configurable:!0,enumerable:!0,get:function(){return n(this,r)}})}var M=function(t,e){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}M(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function W(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function V(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function H(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create,Object.create;var G=!1,X=[],J=new Map,$=Symbol.for("43f7a601");function Q(t,e){Array.isArray(e)?t.push.apply(t,H([],V(e))):t.push(e)}var z=function(t,e){var n,r,i=t(e),o=Reflect.getPrototypeOf(t);return Reflect.has(o,$)&&(n=i,r=J.get(Reflect.get(o,$)),G=!0,Reflect.has(n,$)||Reflect.set(n,$,[]),Q(Reflect.get(n,$),r),i=n),i};function Y(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];if(G){var o=[];Reflect.has(n,$)&&o.push.apply(o,H([],V(Reflect.get(n,$)))),o.push.apply(o,H([],V(X)));for(var a=0;a<o.length;a++){var s=o[a],u=void 0;if(p(s)?u=s.apply(void 0,H([t,n],V(r))):"get"===t&&Reflect.has(s,r[0])?u=Reflect.get(s,r[0],n):Reflect.has(s,t)&&(u=Reflect.get(s,t).apply(void 0,H([n],V(r)))),void 0!==u)return u}}return e.apply(void 0,H([n],V(r)))}var K,Z=(K=function(t){return this.defaultAction(t)},function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(e){var n=Object.assign(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K.call.apply(K,H([n],V(t)))},new(t.bind.apply(t,H([void 0],V(e)))));return Reflect.setPrototypeOf(n,t.prototype),n};return C.get("ie11")?r(e):new Proxy(z(r,e),{apply:function(t,e,n){return Y("apply",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Reflect.apply(t[0],t[1],t[2])},t,e,n)},get:function(t,e,n){return Y("get",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Reflect.get(t[0],t[1],t[2])},t,e,n)},has:function(t,e){return Y("has",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Reflect.has(t[0],t[1])},t,e)},set:function(t,e,n,r){return Y("set",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Reflect.set(t[0],t[1],t[2],t[3])},t,e,n,r)}})}}),tt=function(){function t(){}return t.prototype.parse=function(t){var e=this;return new Promise(function(n,r){e.handleError(t,r)&&e.parseImpl(t,n,r)})},t.prototype.parseImpl=function(t,e,n){var r=this;t.headers.has("Content-Length")&&0===parseFloat(t.headers.get("Content-Length"))||204===t.status?e({}):t.text().then(function(t){return t.replace(/\s/gi,"").length>0?JSON.parse(t):{}}).then(function(t){return e(r.parseODataJSON(t))}).catch(function(t){return n(t)})},t.prototype.handleError=function(t,e){return t.ok||et.init(t).then(e),t.ok},t.prototype.parseODataJSON=function(t){var e=t;return v(t,"d")?e=v(t.d,"results")?t.d.results:t.d:v(t,"value")&&(e=t.value),e},t}(),et=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}N(e,t),e.prototype.parseImpl=function(t,e){t.text().then(e)}}(tt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}N(e,t),e.prototype.parseImpl=function(t,e){t.blob().then(e)}}(tt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}N(e,t),e.prototype.parseImpl=function(t,e){t.json().then(e)}}(tt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}N(e,t),e.prototype.parseImpl=function(t,e){p(t.arrayBuffer)?t.arrayBuffer().then(e):t.buffer().then(e)}}(tt),function(t){function e(e){var n=t.call(this)||this;return n.parser=e,n}N(e,t),e.prototype.parseImpl=function(t,e){this.parser(t).then(e)}}(tt),function(t){function e(e,n,r,i){void 0===r&&(r=n.status),void 0===i&&(i=n.statusText);var o=t.call(this,e)||this;return o.response=n,o.status=r,o.statusText=i,o.isHttpRequestError=!0,o}return N(e,t),e.init=function(t){return n=this,void 0,i=function(){var n;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(r){switch(r.label){case 0:return[4,t.clone().text()];case 1:return n=r.sent(),[2,new e("Error making HttpClient request in queryable ["+t.status+"] "+t.statusText+" ::> "+n,t.clone())]}})},new((r=void 0)||(r=Promise))(function(t,e){function o(t){try{s(i.next(t))}catch(t){e(t)}}function a(t){try{s(i.throw(t))}catch(t){e(t)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r(function(t){t(n)})).then(o,a)}s((i=i.apply(n,[])).next())});var n,r,i},e}(Error));function nt(t){var e;t.options&&t.options.body&&(e=t.options.body,t.options.body="-");var n=JSON.stringify(t,function(t,e){switch(t){case"query":return JSON.stringify(H([],V(e)));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return e}},0),r=JSON.parse(n,function(e,n){switch(e){case"query":return new Map(JSON.parse(n));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return t[e];default:return n}});return e&&(r.options.body=e,t.options.body=e),r}var rt,it=function(){function t(t){void 0===t&&(t={}),this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new tt,query:new Map,url:"",useCaching:!1},nt(t)),this._runtime=null}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=Object.assign({},this.data,nt(t))},enumerable:!1,configurable:!0}),t.prototype.getRuntime=function(){return null===this._runtime?C:this._runtime},t.prototype.setRuntime=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t[0]instanceof T?this._runtime=t[0]:(this._runtime=t[0]?new T(C.export()):new T,t.length>1&&f(t[1])&&this._runtime.assign(t[1])),this},t.prototype.toUrl=function(){return this.data.url},t.prototype.concat=function(t){return this.data.url+=t,this},Object.defineProperty(t.prototype,"query",{get:function(){return this.data.query},enumerable:!1,configurable:!0}),t.prototype.configure=function(t){return E(this.data.options,t),this},t.prototype.configureFrom=function(t){E(this.data.options,t.data.options);var e=t.getRuntime();return e.get("__isDefault__")||this.setRuntime(e),this},t.prototype.usingCaching=function(t){var e=this.getRuntime();if(!e.get("globalCacheDisable")){if(this.data.useCaching=!0,"string"==typeof t){if(y(t))throw Error("Cache key cannot be empty.");t={key:t}}var n={expiration:u(new Date,"second",e.get("defaultCachingTimeoutSeconds")),storeName:e.get("defaultCachingStore")};this.data.cachingOptions=h(n,t)}return this},t.prototype.usingParser=function(t){return this.data.parser=t,this},t.prototype.withPipeline=function(t){return this.data.pipes=t.slice(0),this},t.prototype.append=function(t){this.data.url=c(this.data.url,t)},t.prototype.inBatch=function(t){if(this.hasBatch)throw Error("This query is already part of a batch.");return f(t)&&t.track(this),this},t.prototype.addBatchDependency=function(){return f(this.data.batch)?this.data.batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return f(this.data.batch)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this.data.batch:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentUrl",{get:function(){return this.data.parentUrl},enumerable:!1,configurable:!0}),t.prototype.cloneTo=function(t,e){return void 0===e&&(e={}),e=h({includeBatch:!0,includeQuery:!1},e),t.data=Object.assign({},nt(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},nt(t.data)),t.configureFrom(this),e.includeBatch&&t.inBatch(this.batch),e.includeQuery&&this.query.size>0&&this.query.forEach(function(e,n){return t.query.set(n,e)}),this.data.useCaching&&(t.data.cloneParentWasCaching=!0,t.data.cloneParentCacheOptions=this.data.cachingOptions),t},t}(),ot=function(){function t(){}return Object.defineProperty(t,"activeLogLevel",{get:function(){return t.instance.activeLogLevel},set:function(e){t.instance.activeLogLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return void 0!==t._instance&&null!==t._instance||(t._instance=new at),t._instance},enumerable:!1,configurable:!0}),t.subscribe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){return t.instance.subscribe(e)})},t.clearSubscribers=function(){return t.instance.clearSubscribers()},Object.defineProperty(t,"count",{get:function(){return t.instance.count},enumerable:!1,configurable:!0}),t.write=function(e,n){void 0===n&&(n=1),t.instance.log({level:n,message:e})},t.writeJSON=function(t,e){void 0===e&&(e=1),this.write(JSON.stringify(t),e)},t.log=function(e){t.instance.log(e)},t.error=function(e){t.instance.log({data:e,level:3,message:e.message})},t}(),at=function(){function t(t,e){void 0===t&&(t=2),void 0===e&&(e=[]),this.activeLogLevel=t,this.subscribers=e}return t.prototype.subscribe=function(t){this.subscribers.push(t)},t.prototype.clearSubscribers=function(){var t=this.subscribers.slice(0);return this.subscribers.length=0,t},Object.defineProperty(t.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!1,configurable:!0}),t.prototype.write=function(t,e){void 0===e&&(e=1),this.log({level:e,message:t})},t.prototype.log=function(t){void 0!==t&&this.activeLogLevel<=t.level&&this.subscribers.map(function(e){return e.log(t)})},t}();function st(t,e){return new Promise(function(n){t.result=e,t.hasResult=!0,n(t)})}function ut(t){return t.pipes.length>0?t.pipes.shift()(t):Promise.resolve(t)}function ct(t){return void 0===t&&(t=!1),function(e,n,r){var i=r.value;r.value=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return!t&&r.length>0&&v(r[0],"hasResult")&&r[0].hasResult?(ot.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(r[0])):(ot.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),i.apply(e,r).then(function(t){return ut(t)}))}}}!function(t){t[t.Verbose=0]="Verbose",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Off=99]="Off"}(rt||(rt={})),function(){function t(){}t.prototype.log=function(t){var e=this.format(t);switch(t.level){case 0:case 1:console.log(e);break;case 2:console.warn(e);break;case 3:console.error(e)}},t.prototype.format=function(t){var e=[];if(e.push("Message: "+t.message),void 0!==t.data)try{e.push(" Data: "+JSON.stringify(t.data))}catch(t){e.push(" Data: Error in stringify of supplied data "+t)}return e.join("")}}();var lt,pt=function(){function t(){}return t.logStart=function(t){return new Promise(function(e){ot.log({data:1===ot.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Beginning "+t.method+" request ("+t.url+")"}),e(t)})},t.caching=function(t){return new Promise(function(e){if(t.useCaching){ot.write("["+t.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new F(t.url.toLowerCase());if(void 0!==t.cachingOptions&&(n=h(n,t.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return ot.log({data:1===ot.activeLogLevel?{}:r,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),p(t.batchDependency)&&t.batchDependency(),v(t.parser,"hydrate")&&(r=t.parser.hydrate(r)),st(t,r).then(function(t){return e(t)})}ot.write("["+t.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),t.parser=new A(t.parser,n)}return e(t)})},t.send=function(t){return new Promise(function(e,n){if(t.isBatched){var r=t.batch.add(t);p(t.batchDependency)&&t.batchDependency(),ot.write("["+t.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+t.batch.batchId+".",1),e(st(t,r))}else{ot.write("["+t.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var i=t.clientFactory(),o=h(t.options||{},{method:t.method});i.fetch(t.url,o).then(function(e){return t.parser.parse(e)}).then(function(e){return st(t,e)}).then(function(t){return e(t)}).catch(function(t){return n(t)})}})},t.logEnd=function(t){return new Promise(function(e){t.isBatched?ot.log({data:1===ot.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") "+t.method+" request will complete in batch "+t.batch.batchId+"."}):ot.log({data:1===ot.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Completing "+t.method+" request."}),e(t)})},W([ct(!0)],t,"logStart",null),W([ct()],t,"caching",null),W([ct()],t,"send",null),W([ct(!0)],t,"logEnd",null),t}(),ft=(lt=[pt.logStart,pt.caching,pt.send,pt.logEnd].slice(0),function(t){return function(e){return function(n){return function(t){if(t.pipes.length<1)throw ot.write("["+t.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",3),Error("Request pipeline contains no methods!");var e=ut(t).then(function(t){return function(t){return ot.log({data:0===ot.activeLogLevel?t.result:{},level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(t.result)}(t)}).catch(function(t){throw ot.error(t),t});return t.isBatched&&t.batch.addResolveBatchDependency(e),e}(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:t,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:f(n.batch),method:e,options:null,parentUrl:"",parser:new tt,pipes:lt.slice(0),query:new Map,requestId:l(),url:"",useCaching:/^get$/i.test(n.method)&&n.useCaching},nt(n)))}}});function ht(t,e){return Object.assign({body:g(t)},e)}function dt(t,e){return Object.assign({headers:t},e)}var yt=function(t,e){return(yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function gt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}yt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function vt(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function bt(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})}function mt(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function wt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Pt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}function It(t){return{__metadata:{type:t}}}function xt(t){if(y(t))return"";var e=t.indexOf("_api/");return e<0&&(e=t.indexOf("_vti_bin/")),e>-1?t.substr(0,e):t}function St(t){return function(e,n,r){void 0===r&&(r=Object.getOwnPropertyDescriptor(e,n));var i=r.value;return r.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return bt(this,void 0,void 0,function(){return mt(this,function(n){return this.configure(dt({"X-PnPjs-Tracking":t})),[2,i.apply(this,e)]})})},r}}Object.create,Object.create,St.getClientTag=function(t,e){if(void 0===e&&(e=!0),t.has("X-PnPjs-Tracking")){var n=t.get("X-PnPjs-Tracking");if(e&&t.delete("X-PnPjs-Tracking"),!y(n))return n}return""},St.configure=function(t,e){return t.configure(dt({"X-PnPjs-Tracking":e}))},St.isTagged=function(t){return t.data.options.headers&&t.data.options.headers["X-PnPjs-Tracking"]};var _t=function(){function t(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(this._runtime=e.length>0&&e[0]instanceof T?e[0]:C,this._impl=e.length>1&&f(e[1])?e[1]:(null===(t=this._runtime.get("sp"))||void 0===t?void 0:t.fetchClientFactory())||null,null===this._impl)throw Error("Could not generate fetchClientFactory in SPHttpClient.");this._digestCache=Ct(this)}return t.prototype.fetch=function(t,e){var n;return void 0===e&&(e={}),bt(this,void 0,void 0,function(){var r,i,o,a,s;return mt(this,function(u){switch(u.label){case 0:return r=h(e,{cache:"no-cache",credentials:"same-origin"},!0),R(i=new Headers,null===(n=this._runtime.get("sp"))||void 0===n?void 0:n.headers),R(i,e.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||(o=St.getClientTag(i),(a="PnPCoreJS:2.7.0:"+o).length>32&&(a=a.substr(0,32)),i.append("X-ClientService-ClientTag",a)),!(r=h(r,{headers:i})).method||"GET"===r.method.toUpperCase()||i.has("X-RequestDigest")||i.has("Authorization")?[3,2]:[4,this._digestCache(xt(t))];case 1:s=u.sent(),i.append("X-RequestDigest",s),u.label=2;case 2:return[2,this.fetchRaw(t,r)]}})})},t.prototype.fetchRaw=function(t,e){var n=this;void 0===e&&(e={});var r=new Headers;R(r,e.headers),e=h(e,{headers:r});var i=function(r){var o=function(t){var e;t.headers.has("Retry-After")?e=1e3*parseInt(t.headers.get("Retry-After"),10):(e=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(new et("Retry count exceeded ("+r.retryCount+") for request. Response status: ["+t.status+"] "+t.statusText,t)):setTimeout(s(n,i,r),e)};n._impl.fetch(t,e).then(function(t){429===t.status?o(t):r.resolve(t)}).catch(function(t){503===t.status||504===t.status?o(t):r.reject(t)})};return new Promise(function(t,e){i.call(n,{attempts:0,delay:100,reject:e,resolve:t,retryCount:7})})},t.prototype.get=function(t,e){void 0===e&&(e={});var n=h(e,{method:"GET"});return this.fetch(t,n)},t.prototype.post=function(t,e){void 0===e&&(e={});var n=h(e,{method:"POST"});return this.fetch(t,n)},t.prototype.patch=function(t,e){void 0===e&&(e={});var n=h(e,{method:"PATCH"});return this.fetch(t,n)},t.prototype.delete=function(t,e){void 0===e&&(e={});var n=h(e,{method:"DELETE"});return this.fetch(t,n)},t}(),Tt=new Map;function Ct(t){var e=this;return function(n){return bt(e,void 0,void 0,function(){var e,r,i,o,a,s,l,p;return mt(this,function(f){switch(f.label){case 0:return void 0!==(e=Tt.get(n))&&new Date<e.expiration?[2,e.value]:(r=c(n,"/_api/contextinfo"),i={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},[4,t.fetchRaw(r,{cache:"no-cache",credentials:"same-origin",headers:h(i,null===(p=null===(l=t._runtime.get("sp"))||void 0===l?void 0:l.sp)||void 0===p?void 0:p.headers,!0),method:"POST"})]);case 1:return o=f.sent(),[4,(new tt).parse(o).then(function(t){return t.GetContextWebInformation})];case 2:return a=f.sent(),s={expiration:u(new Date,"second",a.FormDigestTimeoutSeconds),value:a.FormDigestValue},Tt.set(n,s),[2,s.value]}})})}}function Ot(t,e){var n,r;return void 0===e&&(e=C),bt(this,void 0,void 0,function(){var i,o,a,s,u;return mt(this,function(l){if(d(t))return[2,t];if(i=null===(n=e.get("sp"))||void 0===n?void 0:n.baseUrl,o=null===(r=e.get("sp"))||void 0===r?void 0:r.fetchClientFactory,!y(i))return[2,c(i,t)];if(a=e.get("spfxContext"))return[2,c(a.pageContext.web.absoluteUrl,t)];if(o&&v(s=o(),"siteUrl"))return[2,c(s.siteUrl,t)];if(void 0!==O.a._spPageContextInfo){if(v(O.a._spPageContextInfo,"webAbsoluteUrl"))return[2,c(O.a._spPageContextInfo.webAbsoluteUrl,t)];if(v(O.a._spPageContextInfo,"webServerRelativeUrl"))return[2,c(O.a._spPageContextInfo.webServerRelativeUrl,t)]}return void 0!==O.a.location&&(u=O.a.location.toString().toLowerCase(),["/_layouts/","/siteassets/","/sitepages/"].forEach(function(e){var n=u.indexOf(e);if(n>0)return c(u.substr(0,n),t)})),[2,t]})})}var Rt=function(t){return function(e,n){return bt(this,void 0,void 0,function(){var r,i,o,a,s;return mt(this,function(u){switch(u.label){case 0:return r=e.getRuntime(),i=ft(function(t){return function(){return new _t(t)}}(r))(t),o=nt(e.data),a=f(o.batch)?o.batch.addDependency():function(){},[4,Ot(e.toUrlAndQuery(),r)];case 1:return s=u.sent(),E(o.options,n),[2,i(Object.assign({},o,{batchDependency:a,url:s}))]}})})}},Et=function(t,e){return t.data.cloneParentWasCaching&&t.usingCaching(t.data.cloneParentCacheOptions),t._forceCaching&&(t.data.useCaching=!0),Rt("GET")(t,e)},Ut=function(t,e){return Rt("POST")(t,e)},Lt=function(t){return Z(t)},kt=function(t){function e(e,n){var r=this,i="",o="",a=new Map;if("string"==typeof e)if(d(e)||e.lastIndexOf("/")<0)o=e,i=c(e,n);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){var s=e.lastIndexOf("/");o=e.slice(0,s),n=c(e.slice(s),n),i=c(o,n)}else s=e.lastIndexOf("("),o=e.slice(0,s),i=c(e,n);else{i=c(o=e.toUrl(),n||"");var u=e.query.get("@target");void 0!==u&&a.set("@target",u)}return r=t.call(this,{parentUrl:o,query:a,url:i})||this,"string"!=typeof e&&r.configureFrom(e),r._forceCaching=!1,r}return gt(e,t),e.prototype.toUrlAndQuery=function(){var t=new Map(this.query),e=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(e,n,r){return ot.write("Rewriting aliased parameter from match "+e+" to label: "+n+" value: "+r,0),t.set(n,"'"+r+"'"),n});if(t.size>0){var n=e.indexOf("?")>-1?"&":"?";e+=""+n+Array.from(t).map(function(t){return t[0]+"="+t[1]}).join("&")}return e},e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this.query.set("$select",t.map(encodeURIComponent).join(",")),this},e.prototype.get=function(t){return Et(this,t)},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this.query.set("$expand",t.map(encodeURIComponent).join(",")),this},e.prototype.clone=function(e,n,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var o=t.prototype.cloneTo.call(this,e(this,n),{includeBatch:r,includeQuery:i});if(!i){var a="@target";this.query.has(a)&&o.query.set(a,this.query.get(a))}return o},e.prototype.defaultAction=function(t){return Et(this,t)},e.prototype.getParent=function(t,e,n,r){void 0===e&&(e=this.parentUrl);var i=t(e,n).configureFrom(this),o="@target";return this.query.has(o)&&i.query.set(o,this.query.get(o)),void 0!==r&&(i=i.inBatch(r)),i},e}(it),Dt=Lt(kt),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.filter=function(t){return this.query.set("$filter",encodeURIComponent(t)),this},e.prototype.orderBy=function(t,e){void 0===e&&(e=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(encodeURIComponent(t)+" "+(e?"asc":"desc")),this.query.set(n,r.join(",")),this},e.prototype.skip=function(t){return this.query.set("$skip",t.toString()),this},e.prototype.top=function(t){return this.query.set("$top",t.toString()),this},e}(kt),qt=Lt(jt),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype._update=function(t,e){var n=this;return function(r){return Ut(St.configure(n,t+".Update"),{body:g(h(It(t),r)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(t){return e(t,r)})}},e}(kt),At=Lt(Ft);function Bt(t){return function(){return e=St.configure(this,t+".delete"),n=Object.assign(dt({"X-HTTP-Method":"DELETE"}),void 0),Ut(e,n);var e,n}}function Mt(t){return function(e){return void 0===e&&(e="*"),function(t,e,n){void 0===n&&(n="*");var r=Object.assign(dt({"X-HTTP-Method":"DELETE","IF-Match":n}),{});return Ut(t,r)}(St.configure(this,t+".delete"),0,e)}}var Nt=function(t){function e(e,n){void 0===n&&(n=C);var r=t.call(this)||this;return r.url=e,r.runtime=n,r}return gt(e,t),e.ParseResponse=function(t){for(var e,n,r=[],i=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),o=t.split("\n"),a="batch",s=0;s<o.length;++s){var u=o[s];switch(a){case"batch":if("--batchresponse_"===u.substr(0,"--batchresponse_".length))a="batchHeaders";else if(""!==u.trim())throw Error("Invalid response, line "+s);break;case"batchHeaders":""===u.trim()&&(a="status");break;case"status":var c=i.exec(u);if(3!==c.length)throw Error("Invalid status, line "+s);e=parseInt(c[1],10),n=c[2],a="statusHeaders";break;case"statusHeaders":""===u.trim()&&(a="body");break;case"body":r.push(204===e?new Response:new Response(u,{status:e,statusText:n})),a="batch"}}if("status"!==a)throw Error("Unexpected end of input");return r},e.prototype.executeImpl=function(){var t;return bt(this,void 0,void 0,function(){var n,r,i,o,a,s,u,p,f,h,y,g,b,m,w=this;return mt(this,function(P){switch(P.label){case 0:return ot.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1?(ot.write("Resolving empty batch.",1),[2]):(n=new _t(this.runtime),[4,Ot(this.url,this.runtime)]);case 1:for(r=P.sent(),i=[],o="",a=0;a<this.requests.length;a++)"GET"===(s=this.requests[a]).method?(o.length>0&&(i.push("--changeset_"+o+"--\n\n"),o=""),i.push("--batch_"+this.batchId+"\n")):(o.length<1&&(o=l(),i.push("--batch_"+this.batchId+"\n"),i.push('Content-Type: multipart/mixed; boundary="changeset_'+o+'"\n\n')),i.push("--changeset_"+o+"\n")),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n"),u=new Headers,p=d(s.url)?s.url:c(r,s.url),ot.write("["+this.batchId+"] ("+(new Date).getTime()+") Adding request "+s.method+" "+p+" to batch.",0),"GET"!==s.method?(f=s.method,h=s.options.headers,v(s,"options")&&v(s.options,"headers")&&void 0!==h["X-HTTP-Method"]&&(f=h["X-HTTP-Method"],delete h["X-HTTP-Method"]),i.push(f+" "+p+" HTTP/1.1\n"),u.set("Content-Type","application/json;odata=verbose;charset=utf-8")):i.push(s.method+" "+p+" HTTP/1.1\n"),R(u,null===(t=this.runtime.get("sp"))||void 0===t?void 0:t.headers),s.options&&R(u,s.options.headers),u.has("Accept")||u.append("Accept","application/json"),u.has("Content-Type")||u.append("Content-Type","application/json;odata=verbose;charset=utf-8"),u.has("X-ClientService-ClientTag")||u.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-2.7.0:batch"),u.forEach(function(t,e){i.push(e+": "+t+"\n")}),i.push("\n"),s.options.body&&i.push(s.options.body+"\n\n");return o.length>0&&(i.push("--changeset_"+o+"--\n\n"),o=""),i.push("--batch_"+this.batchId+"--\n"),y={body:i.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+this.batchId},method:"POST"},ot.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),[4,n.fetch(c(r,"/_api/$batch"),y)];case 2:return(g=P.sent()).ok?[3,4]:[4,et.init(g)];case 3:throw P.sent();case 4:return[4,g.clone().text()];case 5:if(b=P.sent(),(m=e.ParseResponse(b)).length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return ot.write("["+this.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),[2,m.reduce(function(t,e,n){return t.then(function(){return bt(w,void 0,void 0,function(){var t,r,i,o;return mt(this,function(a){switch(a.label){case 0:t=this.requests[n],ot.write("["+t.id+"] ("+(new Date).getTime()+") Resolving request in batch "+this.batchId+".",1),a.label=1;case 1:return a.trys.push([1,3,,4]),i=(r=t).resolve,[4,t.parser.parse(e)];case 2:return i.apply(r,[a.sent()]),[3,4];case 3:return o=a.sent(),t.reject(o),[3,4];case 4:return[2]}})})})},Promise.resolve(void 0))]}})})},e}(j);function Wt(t){return function(e){return function(e){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:t)||this}return gt(n,e),n}(e)}}var Vt,Ht="00000000-0000-0000-0000-000000000000";function Gt(t,e){void 0===e&&(e=C),e.assign(t)}Vt=function(t){var e=t.get("sp"),n=Object.assign({},{fetchClientFactory:function(){return new U}},e);t.assign({sp:n})},_.indexOf(Vt)<0&&(Vt(C),_.push(Vt));var Xt,Jt,$t,Qt=function(){function t(t,e,n){void 0===t&&(t={}),void 0===e&&(e=""),void 0===n&&(n=C),this._options=t,this._baseUrl=e,this._runtime=n}return t.prototype.configure=function(e,n){return void 0===n&&(n=""),new t(e,n)},t.prototype.setup=function(t){t.pageContext?Gt({spfxContext:t},this._runtime):Gt(t,this._runtime)},t.prototype.createIsolated=function(e){return bt(this,void 0,void 0,function(){var n,r,i,o,a;return mt(this,function(s){return e=Object.assign({baseUrl:"",cloneGlobal:!0,config:{},options:{}},e||{}),n=e.baseUrl,r=e.cloneGlobal,i=e.options,o=e.config,(a=r?new T(C.export()):new T).assign(o),[2,new t(i,n,a)]})})},t.prototype.childConfigHook=function(t){return t({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})},t}();function zt(t){return y(t)?"":/!(@.*?)::(.*?)/gi.test(t)?t.replace(/!(@.*?)::(.*)$/gi,function(t,e,n){return ot.write("Rewriting aliased parameter from match "+t+" to label: "+e+" value: "+n,0),"!"+e+"::"+encodeURIComponent(n.replace(/'/gi,"''"))}):encodeURIComponent(t.replace(/'/gi,"''"))}function Yt(t){var e=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(v(t,n[0])&&"SP.Web"===t[n[0]])v(t,n[4])?e.push(t[n[4]]):v(t,n[2])&&e.push(t.__metadata.uri);else if(v(t,n[3])&&v(t,n[1])){var r=d(t[n[1]])?t[n[1]].split("_api")[1]:t[n[1]];e.push(xt(t[n[3]]),"_api",r)}else v(t,n[1])?e.push("_api",t[n[1]]):v(t,n[2])&&e.push(t.__metadata.uri);return e.length<1?(ot.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):c.apply(void 0,Pt([],wt(e)))}new Qt,function(t){t[t.None=0]="None",t[t.User=1]="User",t[t.DistributionList=2]="DistributionList",t[t.SecurityGroup=4]="SecurityGroup",t[t.SharePointGroup=8]="SharePointGroup",t[t.All=15]="All"}(Xt||(Xt={})),function(t){t[t.None=0]="None",t[t.UserInfoList=1]="UserInfoList",t[t.Windows=2]="Windows",t[t.MembershipProvider=4]="MembershipProvider",t[t.RoleProvider=8]="RoleProvider",t[t.All=15]="All"}(Jt||(Jt={})),function(t){t[t.Invalid=-1]="Invalid",t[t.DefaultView=0]="DefaultView",t[t.NormalView=1]="NormalView",t[t.DialogView=2]="DialogView",t[t.View=3]="View",t[t.DisplayForm=4]="DisplayForm",t[t.DisplayFormDialog=5]="DisplayFormDialog",t[t.EditForm=6]="EditForm",t[t.EditFormDialog=7]="EditFormDialog",t[t.NewForm=8]="NewForm",t[t.NewFormDialog=9]="NewFormDialog",t[t.SolutionForm=10]="SolutionForm",t[t.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}($t||($t={})),function(t){function e(e){var n=t.call(this)||this;return n.factory=e,n.hydrate=function(t){return h(n.factory(Yt(t),null),t)},n}gt(e,t),e.prototype.parse=function(e){var n=this;return t.prototype.parse.call(this,e).then(function(t){return h(n.factory(Yt(t),null),t)})}}(tt),function(t){function e(e){var n=t.call(this)||this;return n.factory=e,n.hydrate=function(t){return t.map(function(t){return h(n.factory(Yt(t),null),t)})},n}gt(e,t),e.prototype.parse=function(e){var n=this;return t.prototype.parse.call(this,e).then(function(t){return t.map(function(t){return h(n.factory(Yt(t),null),t)})})}}(tt);var Kt=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),Object.defineProperty(e.prototype,"rootWeb",{get:function(){return St.configure(ee(this,"rootweb").configureFrom(this),"si.rootWeb")},enumerable:!1,configurable:!0}),e.prototype.getChanges=function(t){var e=ht({query:h(It("SP.ChangeQuery"),t)});return Ut(this.clone(ee,"getchanges"),e)},e.prototype.openWebById=function(t){return bt(this,void 0,void 0,function(){var e;return mt(this,function(n){switch(n.label){case 0:return[4,Ut(this.clone(Kt,"openWebById('"+t+"')"))];case 1:return[2,{data:e=n.sent(),web:ee(xt(Yt(e))).configureFrom(this)}]}})})},e.prototype.getRootWeb=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,this.rootWeb.select("Url")()];case 1:return t=e.sent(),[2,St.configure(ee(t.Url).configureFrom(this),"si.getRootWeb")]}})})},e.prototype.getContextInfo=function(){return bt(this,void 0,void 0,function(){var t,e,n,r;return mt(this,function(i){switch(i.label){case 0:return t=Kt(this.parentUrl,"_api/contextinfo").configureFrom(this),e=St.configure(t,"si.getContextInfo"),[4,Ut(e)];case 1:return v(n=i.sent(),"GetContextWebInformation")?((r=n.GetContextWebInformation).SupportedSchemaVersions=r.SupportedSchemaVersions.results,[2,r]):[2,n]}})})},e.prototype.createBatch=function(){return new Nt(this.parentUrl,this.getRuntime())},e.prototype.delete=function(){return bt(this,void 0,void 0,function(){var t,e;return mt(this,function(n){switch(n.label){case 0:return[4,this.clone(Kt,"").select("Id")()];case 1:return t=n.sent(),e=St.configure(Kt(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete"),[4,Ut(e,ht({siteId:t.Id}))];case 2:return n.sent(),[2]}})})},e.prototype.getDocumentLibraries=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return(e=St.configure(Dt("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries")).query.set("@v","'"+zt(t)+"'"),[4,e()];case 1:return[2,v(n=r.sent(),"GetDocumentLibraries")?n.GetDocumentLibraries:n]}})})},e.prototype.getWebUrlFromPageUrl=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return(e=St.configure(Dt("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl")).query.set("@v","'"+zt(t)+"'"),[4,e()];case 1:return[2,v(n=r.sent(),"GetWebUrlFromPageUrl")?n.GetWebUrlFromPageUrl:n]}})})},e.prototype.createCommunicationSite=function(t,e,n,r,i,o,a,s,u){return void 0===e&&(e=1033),void 0===n&&(n=!1),bt(this,void 0,void 0,function(){return mt(this,function(c){return[2,this.createCommunicationSiteFromProps({Classification:o,Description:i,HubSiteId:s,Lcid:e,Owner:u,ShareByEmailEnabled:n,SiteDesignId:a,Title:t,Url:r})]})})},e.prototype.createCommunicationSiteFromProps=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){return e=Object.assign({},{Classification:"",Description:"",HubSiteId:Ht,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:Ht,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:Ht},t),n=ht({request:h(It("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),e)}),[2,Ut(Kt(xt(this.toUrl()),"/_api/SPSiteManager/Create"),n)]})})},e.prototype.exists=function(t){return bt(this,void 0,void 0,function(){var e;return mt(this,function(n){switch(n.label){case 0:return e=ht({url:t}),[4,Ut(Kt(xt(this.toUrl()),"/_api/SP.Site.Exists"),e)];case 1:return[2,n.sent()]}})})},e.prototype.createModernTeamSite=function(t,e,n,r,i,o,a,s,u){return bt(this,void 0,void 0,function(){return mt(this,function(c){return[2,this.createModernTeamSiteFromProps({alias:e,classification:o,description:i,displayName:t,hubSiteId:s,isPublic:n,lcid:r,owners:a,siteDesignId:u})]})})},e.prototype.createModernTeamSiteFromProps=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){return e=Object.assign({},{classification:"",description:"",hubSiteId:Ht,isPublic:!0,lcid:1033,owners:[]},t),n={alias:e.alias,displayName:e.displayName,isPublic:e.isPublic,optionalParams:{Classification:e.classification,CreationOptions:{results:["SPSiteLanguage:"+e.lcid,"HubSiteId:"+e.hubSiteId]},Description:e.description,Owners:{results:e.owners}}},e.siteDesignId&&n.optionalParams.CreationOptions.results.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+e.siteDesignId),[2,Ut(Kt(xt(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),ht(n))]})})},vt([St("si.getChanges")],e.prototype,"getChanges",null),vt([St("si.openWebById")],e.prototype,"openWebById",null),vt([Wt("_api/site")],e)}(Ft));Reflect.defineProperty(Qt.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(function(t){var e=t.options,n=t.baseUrl,r=t.runtime;return Kt(n).configure(e).setRuntime(r)})}});var Zt=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.add=function(t,e,n,r,i,o){return void 0===n&&(n=""),void 0===r&&(r="STS"),void 0===i&&(i=1033),void 0===o&&(o=!0),bt(this,void 0,void 0,function(){var a,s;return mt(this,function(u){switch(u.label){case 0:return a=ht({parameters:h(It("SP.WebCreationInformation"),{Description:n,Language:i,Title:t,Url:e,UseSamePermissionsAsParentSite:o,WebTemplate:r})}),[4,Ut(this.clone(Zt,"add"),a)];case 1:return[2,{data:s=u.sent(),web:ee(Yt(s).replace(/_api\/web\/?/i,"")).configureFrom(this)}]}})})},vt([St("ws.add")],e.prototype,"add",null),vt([Wt("webs")],e)}(jt)),te=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delete=Bt("w"),e}return gt(e,t),Object.defineProperty(e.prototype,"webs",{get:function(){return Zt(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allProperties",{get:function(){return St.configure(this.clone(At,"allproperties"),"w.allprops")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webinfos",{get:function(){return St.configure(qt(this,"webinfos"),"w.webinfos")},enumerable:!1,configurable:!0}),e.prototype.getParentWeb=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,Et(this.select("ParentWeb/Id").expand("ParentWeb"))];case 1:return[2,(null==(t=e.sent().ParentWeb)?void 0:t.Id)?Kt(this.parentUrl).openWebById(t.Id):null]}})})},e.prototype.update=function(t){return bt(this,void 0,void 0,function(){var e;return mt(this,function(n){switch(n.label){case 0:return e=ht(h(It("SP.Web"),t),dt({"X-HTTP-Method":"MERGE"})),[4,Ut(this,e)];case 1:return[2,{data:n.sent(),web:this}]}})})},e.prototype.applyTheme=function(t,e,n,r){var i=ht({backgroundImageUrl:n,colorPaletteUrl:t,fontSchemeUrl:e,shareGenerated:r});return Ut(this.clone(ee,"applytheme"),i)},e.prototype.applyWebTemplate=function(t){var e=this.clone(ee,"applywebtemplate");return e.concat("(webTemplate='"+zt(t)+"')"),Ut(e)},e.prototype.getChanges=function(t){var e=ht({query:h(It("SP.ChangeQuery"),t)});return Ut(this.clone(ee,"getchanges"),e)},e.prototype.mapToIcon=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=""),Et(this.clone(ee,"maptoicon(filename='"+zt(t)+"', progid='"+zt(n)+"', size="+e+")"))},e.prototype.getStorageEntity=function(t){return Et(this.clone(ee,"getStorageEntity('"+zt(t)+"')"))},e.prototype.setStorageEntity=function(t,e,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),Ut(this.clone(ee,"setStorageEntity"),ht({comments:r,description:n,key:t,value:e}))},e.prototype.removeStorageEntity=function(t){return Ut(this.clone(ee,"removeStorageEntity('"+zt(t)+"')"))},e.prototype.getSubwebsFilteredForCurrentUser=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1);var n=this.clone(qt,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+t+",nConfigurationFilter="+e+")");return St.configure(n,"w.getSubwebsFilteredForCurrentUser")},e.prototype.createBatch=function(){return new Nt(this.parentUrl,this.getRuntime())},e.prototype.availableWebTemplates=function(t,e){void 0===t&&(t=1033),void 0===e&&(e=!0);var n="getavailablewebtemplates(lcid="+t+", doincludecrosslanguage="+e+")";return St.configure(qt(this,n),"w.availableWebTemplates")},vt([St("w.getParentWeb")],e.prototype,"getParentWeb",null),vt([St("w.update")],e.prototype,"update",null),vt([St("w.applyTheme")],e.prototype,"applyTheme",null),vt([St("w.applyWebTemplate")],e.prototype,"applyWebTemplate",null),vt([St("w.getChanges")],e.prototype,"getChanges",null),vt([St("w.mapToIcon")],e.prototype,"mapToIcon",null),vt([St("w.getStorageEntity")],e.prototype,"getStorageEntity",null),vt([St("w.setStorageEntity")],e.prototype,"setStorageEntity",null),vt([St("w.removeStorageEntity")],e.prototype,"removeStorageEntity",null),vt([Wt("_api/web")],e)}(Ft),ee=Lt(te);function ne(t){return{DecodedUrl:t,__metadata:{type:"SP.ResourcePath"}}}Reflect.defineProperty(Qt.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(function(t){var e=t.options,n=t.baseUrl,r=t.runtime;return ee(n).configure(e).setRuntime(r)})}}),Qt.prototype.createBatch=function(){return this.web.createBatch()};var re,ie,oe=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.getById=function(t){return St.configure(se(this).concat("('"+t+"')"),"ls.getById")},e.prototype.getByTitle=function(t){return St.configure(se(this,"getByTitle('"+zt(t)+"')"),"ls.getByTitle")},e.prototype.add=function(t,e,n,r,i){return void 0===e&&(e=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===i&&(i={}),bt(this,void 0,void 0,function(){var o;return mt(this,function(a){switch(a.label){case 0:return o=Object.assign({AllowContentTypes:r,BaseTemplate:n,ContentTypesEnabled:r,Description:e,Title:t},It("SP.List"),i),[4,Ut(this,ht(o))];case 1:return[2,{data:a.sent(),list:this.getByTitle(o.Title)}]}})})},e.prototype.ensure=function(t,e,n,r,i){return void 0===e&&(e=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===i&&(i={}),bt(this,void 0,void 0,function(){var o,a;return mt(this,function(s){switch(s.label){case 0:if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");o=h(i,{Title:t,Description:e,ContentTypesEnabled:r},!0),a=this.getByTitle(o.Title),s.label=1;case 1:return s.trys.push([1,4,,6]),[4,a.select("Title")()];case 2:return s.sent(),[4,a.update(o).then(function(t){return t.data})];case 3:return[2,{created:!1,data:s.sent(),list:this.getByTitle(o.Title)}];case 4:return s.sent(),[4,this.add(t,e,n,r,o).then(function(t){return t.data})];case 5:return[2,{created:!0,data:s.sent(),list:this.getByTitle(o.Title)}];case 6:return[2]}})})},e.prototype.ensureSiteAssetsLibrary=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,Ut(this.clone(oe,"ensuresiteassetslibrary"))];case 1:return t=e.sent(),[2,se(Yt(t))]}})})},e.prototype.ensureSitePagesLibrary=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,Ut(this.clone(oe,"ensuresitepageslibrary"))];case 1:return t=e.sent(),[2,se(Yt(t))]}})})},vt([St("ls.add")],e.prototype,"add",null),vt([St("ls.ensure")],e.prototype,"ensure",null),vt([St("ls.ensureSiteAssetsLibrary")],e.prototype,"ensureSiteAssetsLibrary",null),vt([St("ls.ensureSitePagesLibrary")],e.prototype,"ensureSitePagesLibrary",null),vt([Wt("lists")],e)}(jt)),ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delete=Mt("l"),e}return gt(e,t),Object.defineProperty(e.prototype,"effectiveBasePermissions",{get:function(){return St.configure(Dt(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventReceivers",{get:function(){return St.configure(qt(this,"EventReceivers"),"l.eventReceivers")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedFields",{get:function(){return St.configure(Dt(this,"getRelatedFields"),"l.relatedFields")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"informationRightsManagementSettings",{get:function(){return St.configure(Dt(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")},enumerable:!1,configurable:!0}),e.prototype.update=function(t,e){return void 0===e&&(e="*"),bt(this,void 0,void 0,function(){var n,r,i;return mt(this,function(o){switch(o.label){case 0:return n=ht(h(It("SP.List"),t),dt({"IF-Match":e,"X-HTTP-Method":"MERGE"})),[4,Ut(this,n)];case 1:return r=o.sent(),i=v(t,"Title")?this.getParent(se,this.parentUrl,"getByTitle('"+t.Title+"')"):se(this),[2,{data:r,list:i}]}})})},e.prototype.getChanges=function(t){return Ut(this.clone(se,"getchanges"),ht({query:h(It("SP.ChangeQuery"),t)}))},e.prototype.getItemsByCAMLQuery=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.clone(se,"getitems");return Ut(r.expand.apply(r,Pt([],wt(e))),ht({query:h(It("SP.CamlQuery"),t)}))},e.prototype.getListItemChangesSinceToken=function(t){var e=this.clone(se,"getlistitemchangessincetoken").usingParser({parse:function(t){return t.text()}});return Ut(e,ht({query:h(It("SP.ChangeLogItemQuery"),t)}))},e.prototype.recycle=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,Ut(this.clone(se,"recycle"))];case 1:return[2,v(t=e.sent(),"Recycle")?t.Recycle:t]}})})},e.prototype.renderListData=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return(e=this.clone(se,"renderlistdata(@viewXml)")).query.set("@viewXml","'"+t+"'"),[4,Ut(e)];case 1:return n=r.sent(),[2,JSON.parse(v(n,"RenderListData")?n.RenderListData:n)]}})})},e.prototype.renderListDataAsStream=function(t,e,n){var r;void 0===e&&(e=null),void 0===n&&(n=new Map),v(t,"RenderOptions")&&(r=t.RenderOptions,Array.isArray?Array.isArray(r):r&&"number"==typeof r.length&&r.constructor===Array)&&(t.RenderOptions=t.RenderOptions.reduce(function(t,e){return t+e}));var i={parameters:h(It("SP.RenderListDataParameters"),t)};f(e)&&(i=h(i,{overrideParameters:h(It("SP.RenderListDataOverrideParameters"),e)}));var o=this.clone(se,"RenderListDataAsStream",!0,!0);return n&&n.size>0&&n.forEach(function(t,e){return o.query.set(e,t)}),Ut(o,ht(i))},e.prototype.renderListFormData=function(t,e,n){return bt(this,void 0,void 0,function(){var r;return mt(this,function(i){switch(i.label){case 0:return[4,Ut(this.clone(se,"renderlistformdata(itemid="+t+", formid='"+e+"', mode='"+n+"')"))];case 1:return r=i.sent(),[2,JSON.parse(v(r,"RenderListFormData")?r.RenderListFormData:r)]}})})},e.prototype.reserveListItemId=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,Ut(this.clone(se,"reservelistitemid"))];case 1:return[2,v(t=e.sent(),"ReserveListItemId")?t.ReserveListItemId:t]}})})},e.prototype.getListItemEntityTypeFullName=function(){return this.clone(se,null,!1).select("ListItemEntityTypeFullName").usingCaching({expiration:u(new Date,"day",5),key:"PnPjs-ListEntityName:"+this.toUrl(),storeName:"local"})().then(function(t){return t.ListItemEntityTypeFullName})},e.prototype.addValidateUpdateItemUsingPath=function(t,e,n,r,i){return void 0===n&&(n=!1),bt(this,void 0,void 0,function(){var o,a;return mt(this,function(s){switch(s.label){case 0:return o={FolderPath:ne(e)},f(i)&&(i.leafName&&(o.LeafName=ne(i.leafName)),i.objectType&&(o.UnderlyingObjectType=i.objectType)),[4,Ut(this.clone(se,"AddValidateUpdateItemUsingPath()"),ht({bNewDocumentUpdate:n,checkInComment:r,formValues:t,listItemCreateInfo:h(It("SP.ListItemCreationInformationUsingPath"),o)}))];case 1:return[2,v(a=s.sent(),"AddValidateUpdateItemUsingPath")?a.AddValidateUpdateItemUsingPath:a]}})})},e.prototype.getParentInfos=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")()];case 1:return[2,{List:{Id:(t=e.sent()).Id,RootFolderServerRelativePath:t.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:t.RootFolder.ServerRelativeUrl,RootFolderUniqueId:t.RootFolder.UniqueId},ParentWeb:{Id:t.ParentWeb.Id,ServerRelativePath:t.ParentWeb.ServerRelativePath,ServerRelativeUrl:t.ParentWeb.ServerRelativeUrl,Url:t.ParentWeb.Url}}]}})})},vt([St("l.update")],e.prototype,"update",null),vt([St("l.getChanges")],e.prototype,"getChanges",null),vt([St("l.CAMLQuery")],e.prototype,"getItemsByCAMLQuery",null),vt([St("l.ChangesSinceToken")],e.prototype,"getListItemChangesSinceToken",null),vt([St("l.recycle")],e.prototype,"recycle",null),vt([St("l.renderListData")],e.prototype,"renderListData",null),vt([St("l.AsStream")],e.prototype,"renderListDataAsStream",null),vt([St("l.renderListFormData")],e.prototype,"renderListFormData",null),vt([St("l.reserveListItemId")],e.prototype,"reserveListItemId",null),vt([St("l.getListItemEntityTypeFullName")],e.prototype,"getListItemEntityTypeFullName",null),vt([St("l.addValidateUpdateItemUsingPath")],e.prototype,"addValidateUpdateItemUsingPath",null),e}(Ft),se=Lt(ae);!function(t){t[t.None=0]="None",t[t.ContextInfo=1]="ContextInfo",t[t.ListData=2]="ListData",t[t.ListSchema=4]="ListSchema",t[t.MenuView=8]="MenuView",t[t.ListContentType=16]="ListContentType",t[t.FileSystemItemId=32]="FileSystemItemId",t[t.ClientFormSchema=64]="ClientFormSchema",t[t.QuickLaunch=128]="QuickLaunch",t[t.Spotlight=256]="Spotlight",t[t.Visualization=512]="Visualization",t[t.ViewMetadata=1024]="ViewMetadata",t[t.DisableAutoHyperlink=2048]="DisableAutoHyperlink",t[t.EnableMediaTAUrls=4096]="EnableMediaTAUrls",t[t.ParentInfo=8192]="ParentInfo",t[t.PageContextInfo=16384]="PageContextInfo",t[t.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(re||(re={})),function(t){t[t.Display=1]="Display",t[t.Edit=2]="Edit",t[t.New=3]="New"}(ie||(ie={})),B(te,"lists",oe),B(te,"siteUserInfoList",se,"siteuserinfolist"),B(te,"defaultDocumentLibrary",se,"DefaultDocumentLibrary"),B(te,"customListTemplates",qt,"getcustomlisttemplates"),te.prototype.getList=function(t){return se(this,"getList('"+zt(t)+"')")},te.prototype.getCatalog=function(t){return bt(this,void 0,void 0,function(){var e;return mt(this,function(n){switch(n.label){case 0:return[4,this.clone(ee,"getcatalog("+t+")").select("Id").get()];case 1:return e=n.sent(),[2,se(Yt(e))]}})})};var ue=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.getById=function(t){return St.configure(le(this).concat("("+t+")"),"is.getById")},e.prototype.getItemByStringId=function(t){return St.configure(le(this.parentUrl,"getItemByStringId('"+t+"')"),"is.getItemByStringId")},e.prototype.skip=function(t,e){return void 0===e&&(e=!1),e?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+t)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+t)),this},e.prototype.getPaged=function(){return this.usingParser(new de(this))()},e.prototype.getAll=function(t,e){void 0===t&&(t=2e3),void 0===e&&(e="application/json;odata=nometadata"),ot.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var n=ue(this,"").top(t).configure({headers:{Accept:e}});return this.query.forEach(function(t,e){/^\$select|filter|top|expand$/i.test(e)&&n.query.set(e,t)}),new Promise(function(t,e){var r=[],i=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(i).catch(e):t(r)};n.getPaged().then(i).catch(e)})},e.prototype.add=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=null),bt(this,void 0,void 0,function(){var n,r,i,o,a=this;return mt(this,function(s){switch(s.label){case 0:return n=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(e)];case 1:return r=s.sent(),i=ht(h(It(r),t)),o=Ut(this.clone(ue,""),i).then(function(t){return{data:t,item:a.getById(t.Id)}}),n(),[2,o]}})})},e.prototype.ensureListItemEntityTypeName=function(t){return bt(this,void 0,void 0,function(){return mt(this,function(e){return[2,t||this.getParent(se).getListItemEntityTypeFullName()]})})},vt([St("is.getPaged")],e.prototype,"getPaged",null),vt([St("is.getAll")],e.prototype,"getAll",null),vt([St("is.add")],e.prototype,"add",null),vt([Wt("items")],e)}(jt)),ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delete=Mt("i"),e}return gt(e,t),Object.defineProperty(e.prototype,"effectiveBasePermissions",{get:function(){return St.configure(Dt(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectiveBasePermissionsForUI",{get:function(){return St.configure(Dt(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldValuesAsHTML",{get:function(){return St.configure(At(this,"FieldValuesAsHTML"),"i.fvHTML")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldValuesAsText",{get:function(){return St.configure(At(this,"FieldValuesAsText"),"i.fvText")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldValuesForEdit",{get:function(){return St.configure(At(this,"FieldValuesForEdit"),"i.fvEdit")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"versions",{get:function(){return St.configure(pe(this),"i.versions")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.getParent(se,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!1,configurable:!0}),e.prototype.update=function(t,e,n){return void 0===e&&(e="*"),void 0===n&&(n=null),bt(this,void 0,void 0,function(){var r,i,o,a;return mt(this,function(s){switch(s.label){case 0:return r=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(n)];case 1:return i=s.sent(),o=ht(h(It(i),t),dt({"IF-Match":e,"X-HTTP-Method":"MERGE"})),r(),a=St.configure(this.clone(le).usingParser(new ye),"i.update"),[4,Ut(a,o)];case 2:return[2,{data:s.sent(),item:this}]}})})},e.prototype.recycle=function(){return Ut(this.clone(le,"recycle"))},e.prototype.deleteWithParams=function(t){return bt(this,void 0,void 0,function(){return mt(this,function(e){return[2,Ut(this.clone(le,"DeleteWithParameters"),ht({parameters:t}))]})})},e.prototype.getWopiFrameUrl=function(t){return void 0===t&&(t=0),bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return(e=this.clone(le,"getWOPIFrameUrl(@action)")).query.set("@action",t),[4,Ut(e)];case 1:return v(n=r.sent(),"GetWOPIFrameUrl")?[2,n.GetWOPIFrameUrl]:[2,n]}})})},e.prototype.validateUpdateListItem=function(t,e){return void 0===e&&(e=!1),Ut(this.clone(le,"validateupdatelistitem"),ht({formValues:t,bNewDocumentUpdate:e}))},e.prototype.getParentInfos=function(){return bt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,this.select("Id","ParentList/Id","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")()];case 1:return[2,{Item:{Id:(t=e.sent()).Id},ParentList:{Id:t.ParentList.Id,RootFolderServerRelativePath:t.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:t.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:t.ParentList.RootFolder.UniqueId},ParentWeb:{Id:t.ParentList.ParentWeb.Id,ServerRelativePath:t.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:t.ParentList.ParentWeb.ServerRelativeUrl,Url:t.ParentList.ParentWeb.Url}}]}})})},e.prototype.ensureListItemEntityTypeName=function(t){return bt(this,void 0,void 0,function(){return mt(this,function(e){return[2,t||this.list.getListItemEntityTypeFullName()]})})},vt([St("i.recycle")],e.prototype,"recycle",null),vt([St("i.del-params")],e.prototype,"deleteWithParams",null),vt([St("i.getWopiFrameUrl")],e.prototype,"getWopiFrameUrl",null),vt([St("i.validateUpdateListItem")],e.prototype,"validateUpdateListItem",null),e}(Ft),le=Lt(ce),pe=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.getById=function(t){return St.configure(fe(this).concat("("+t+")"),"iv.getById")},vt([Wt("versions")],e)}(jt)),fe=Lt(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delete=Mt("iv"),e}return gt(e,t),e}(Ft)),he=function(){function t(t,e,n){this.parent=t,this.nextUrl=e,this.results=n}return Object.defineProperty(t.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!1,configurable:!0}),t.prototype.getNext=function(){return this.hasNext?St.configure(ue(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise(function(t){return t(null)})},t}(),de=function(t){function e(e){var n=t.call(this)||this;return n._parent=e,n}return gt(e,t),e.prototype.parse=function(t){var e=this;return new Promise(function(n,r){e.handleError(t,r)&&t.json().then(function(t){var r=v(t,"d")&&v(t.d,"__next")?t.d.__next:t["odata.nextLink"];n(new he(e._parent,r,e.parseODataJSON(t)))})})},e}(tt),ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.parse=function(t){var e=this;return new Promise(function(n,r){e.handleError(t,r)&&n({"odata.etag":t.headers.get("etag")})})},e}(tt);B(ae,"items",ue);var ge=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.add=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return"string"==typeof t&&(t={text:t}),e=ht(h(It("Microsoft.SharePoint.Comments.comment"),t)),[4,Ut(this.clone(ge,null),e)];case 1:return n=r.sent(),[2,h(this.getById(n.id),n)]}})})},e.prototype.getById=function(t){return St.configure(ve(this).concat("("+t+")"),"coms.getById")},e.prototype.clear=function(){return Ut(St.configure(this.clone(ge,"DeleteAll"),"coms.clear"))},vt([St("coms.add")],e.prototype,"add",null),vt([Wt("comments")],e)}(jt)),ve=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),Object.defineProperty(e.prototype,"replies",{get:function(){return St.configure(be(this),"com.replies")},enumerable:!1,configurable:!0}),e.prototype.like=function(){return Ut(this.clone(ve,"Like"))},e.prototype.unlike=function(){return Ut(this.clone(ve,"Unlike"))},e.prototype.delete=function(){return Ut(this.clone(ve,"DeleteComment"))},vt([St("com.like")],e.prototype,"like",null),vt([St("com.unlike")],e.prototype,"unlike",null),vt([St("com.delete")],e.prototype,"delete",null),e}(Ft)),be=Lt(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gt(e,t),e.prototype.add=function(t){return bt(this,void 0,void 0,function(){var e,n;return mt(this,function(r){switch(r.label){case 0:return"string"==typeof t&&(t={text:t}),e=ht(h(It("Microsoft.SharePoint.Comments.comment"),t)),[4,Ut(this.clone(be,null),e)];case 1:return n=r.sent(),[2,h(ve(Yt(n)),n)]}})})},vt([St("reps.add")],e.prototype,"add",null),vt([Wt("replies")],e)}(jt));B(ce,"comments",ge),ce.prototype.getLikedBy=function(){return Ut(this.clone(le,"likedBy"))},ce.prototype.like=function(){return bt(this,void 0,void 0,function(){var t,e,n;return mt(this,function(r){switch(r.label){case 0:return[4,this.getParentInfos()];case 1:return t=r.sent(),e=xt(this.toUrl()),n=c(e,"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+"?@a1='{"+t.ParentList.Id+"}'&@a2='"+t.Item.Id+"'&@a3=true",[2,Ut(Dt(n))]}})})},ce.prototype.unlike=function(){return bt(this,void 0,void 0,function(){var t,e,n;return mt(this,function(r){switch(r.label){case 0:return[4,this.getParentInfos()];case 1:return t=r.sent(),e=xt(this.toUrl()),n=c(e,"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+"?@a1='{"+t.ParentList.Id+"}'&@a2='"+t.Item.Id+"'&@a3=false",[2,Ut(Dt(n))]}})})},ce.prototype.getLikedByInformation=function(){return this.clone(le,"likedByInformation").expand("likedby")()};var me=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})},we=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};!function(t,e){G=!0;var n=Reflect.getPrototypeOf(t);Reflect.has(n,$)||Reflect.defineProperty(n,$,{value:l()});var r=n[$];J.has(r)||J.set(r,[]),Q(J.get(r),e)}(ee,{getCurrentUserId:function(){return me(this,void 0,void 0,function(){var t;return we(this,function(e){switch(e.label){case 0:return[4,ee(this,"currentuser").select("Id")()];case 1:return t=e.sent(),[2,parseInt(t.Id,10)]}})})},getArticles:function(t){return void 0===t&&(t=5),me(this,void 0,void 0,function(){var e;return we(this,function(n){switch(n.label){case 0:return[4,this.getCurrentUserId()];case 1:return e=n.sent(),[4,this.lists.getByTitle("VivaDemoCompNews").items.select("Id","Title","svgicon","topic","vivaimg","LikedByStringId").orderBy("Modified",!1).top(t)()];case 2:return[2,n.sent().map(function(t){var n,r=JSON.parse(t.vivaimg);return{id:t.Id,title:t.topic,imageUrl:""+r.serverUrl+r.serverRelativeUrl,iconProperty:t.svgicon,primaryText:t.Title,liked:(null===(n=t.LikedByStringId)||void 0===n?void 0:n.indexOf(""+e))>-1||!1}})]}})})},getArticleContent:function(t){return me(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:return[4,this.lists.getByTitle("VivaDemoCompNews").items.getById(t).select("fullcontent")()];case 1:return[2,e.sent().fullcontent]}})})},likeArticle:function(t){return me(this,void 0,void 0,function(){return we(this,function(e){return[2,this.lists.getByTitle("VivaDemoCompNews").items.getById(t).like()]})})},unlikeArticle:function(t){return me(this,void 0,void 0,function(){return we(this,function(e){return[2,this.lists.getByTitle("VivaDemoCompNews").items.getById(t).unlike()]})})}});var Pe=null,Ie=null;function xe(t){if(void 0===t&&(t=Pe),null!=Ie)return Ie;if(null===Pe&&(Pe=t),null==Pe)throw Error("You must call getSP passing the context within the Extension class before using it child views.");var e=new Qt;return e.setup({spfxContext:t,sp:{headers:{Accept:"application/json;odata=nometadata"}}}),Ie=e,e}var Se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_e=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})},Te=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ce="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'%3E%3Cpath d='M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444z' fill='%23333333'%3E%3C/path%3E%3C/svg%3E",Oe="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2048 2048'%3E%3Cpath d='M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z' fill='%23333333'%3E%3C/path%3E%3C/svg%3E",Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Se(e,t),Object.defineProperty(e.prototype,"data",{get:function(){var t=this;if(this.state.articleIndex<0)return{topic:"",title:"Loading...",content:"",itemId:0,iconsvg:"",imageUrl:"",likedIconUrl:Oe};var e=this.state.articles,n=e[this.state.articleIndex],r=n.content;return r||(setTimeout(function(){return _e(t,void 0,void 0,function(){var t,r;return Te(this,function(i){switch(i.label){case 0:return t=xe(),r=n,[4,t.web.getArticleContent(n.id)];case 1:return r.content=i.sent(),this.setState({articles:e}),[2]}})})},0),r="Fetching..."),{topic:n.title,title:n.primaryText,content:r,itemId:n.id,iconsvg:n.iconProperty,imageUrl:n.imageUrl,likedIconUrl:n.liked?Ce:Oe}},enumerable:!0,configurable:!0}),e.prototype.onAction=function(t){var e=this;t.id.indexOf("like")>-1&&setTimeout(function(){return _e(e,void 0,void 0,function(){var e,n,r;return Te(this,function(i){switch(i.label){case 0:return e=xe(),n=this.state.articles,(r=n[this.state.articleIndex]).liked?[4,e.web.unlikeArticle(t.data.id)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,e.web.likeArticle(t.data.id)];case 3:i.sent(),i.label=4;case 4:return r.liked=!r.liked,r.likedIconUrl=r.liked?Ce:Oe,this.setState({articles:n}),[2]}})})},0)},Object.defineProperty(e.prototype,"template",{get:function(){return n("G/4b")},enumerable:!0,configurable:!0}),e}(r.BaseAdaptiveCardView),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})},Le=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ke="CompanyNews_QUICK_VIEW",De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ee(e,t),e.prototype.onInit=function(){return Ue(this,void 0,void 0,function(){var t=this;return Le(this,function(e){return this.state={articleIndex:-1,articles:[]},this.cardNavigator.register("CompanyNews_CARD_VIEW",function(){return new a}),this.quickViewNavigator.register(ke,function(){return new Re}),setTimeout(function(){return Ue(t,void 0,void 0,function(){var t;return Le(this,function(e){switch(e.label){case 0:return[4,xe(this.context).web.getArticles()];case 1:return t=e.sent(),this.setState({articleIndex:0,articles:t}),[2]}})})},300),[2]})})},Object.defineProperty(e.prototype,"title",{get:function(){return this.properties.title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconProperty",{get:function(){return this.properties.iconProperty||n("EQtN")},enumerable:!0,configurable:!0}),e.prototype.loadPropertyPaneResources=function(){return Ue(this,void 0,void 0,function(){var t;return Le(this,function(e){switch(e.label){case 0:return[4,n.e(0).then(n.bind(null,"5SQN"))];case 1:return t=e.sent(),this._deferredPropertyPane=new t.CompanyNewsPropertyPane,[2]}})})},e.prototype.renderCard=function(){return"CompanyNews_CARD_VIEW"},e.prototype.getPropertyPaneConfiguration=function(){return this._deferredPropertyPane.getPropertyPaneConfiguration()},e}(r.BaseAdaptiveCardExtension);e.default=De},"lz/E":function(t,e){t.exports=n},yLpj:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n}})});